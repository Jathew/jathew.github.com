<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lyu7&#39;s notes</title>
  <subtitle>其疾如风，其徐如林，侵掠如火，不动如山。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://jathew.github.io/"/>
  <updated>2015-11-23T10:14:02.000Z</updated>
  <id>http://jathew.github.io/</id>
  
  <author>
    <name>Lyu7</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Android 异常（不定期更新）</title>
    <link href="http://jathew.github.io/2015/11/23/Android%20%E5%BC%82%E5%B8%B8%EF%BC%88%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <id>http://jathew.github.io/2015/11/23/Android 异常（不定期更新）/</id>
    <published>2015-11-23T10:14:02.000Z</published>
    <updated>2015-11-23T10:14:02.000Z</updated>
    
    <content type="html">&lt;p&gt;##Exception 3&lt;/p&gt;
&lt;h4 id=&quot;关键字：&quot;&gt;&lt;a href=&quot;#关键字：&quot; class=&quot;headerlink&quot; title=&quot;关键字：&quot;&gt;&lt;/a&gt;关键字：&lt;/h4&gt;&lt;p&gt;Android studio gradle add tools:replace&lt;/p&gt;
&lt;h4 id=&quot;log&quot;&gt;&lt;a href=&quot;#log&quot; class=&quot;headerlink&quot; title=&quot;log&quot;&gt;&lt;/a&gt;log&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;Error:(26, 9) Attribute application@icon value=(@drawable/logo) from AndroidManifest.xml:26:9
Error:(28, 9) Attribute application@theme value=(@style/ThemeActionBar) from AndroidManifest.xml:28:9
is also present at XXXX-trunk:XXXXLib:unspecified:15:9 value=(@style/AppTheme)
Suggestion: add &amp;apos;tools:replace=&amp;quot;android:theme&amp;quot;&amp;apos; to  element at AndroidManifest.xml:24:5 to override
Error:Execution failed for task &amp;apos;:XXXX:processDebugManifest&amp;apos;.
 Manifest merger failed with multiple errors, see logs
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&quot;现象&quot;&gt;&lt;a href=&quot;#现象&quot; class=&quot;headerlink&quot; title=&quot;现象&quot;&gt;&lt;/a&gt;现象&lt;/h4&gt;&lt;p&gt;用gradle编译工程，出错，无法运行&lt;/p&gt;
&lt;h4 id=&quot;原因及解决办法&quot;&gt;&lt;a href=&quot;#原因及解决办法&quot; class=&quot;headerlink&quot; title=&quot;原因及解决办法&quot;&gt;&lt;/a&gt;原因及解决办法&lt;/h4&gt;&lt;p&gt;原因：AS的Gradle插件默认会启用Manifest Merger Tool，若Library项目中也定义了与主项目相同的属性（例如默认生成的android:icon和android:theme），则此时会合并失&lt;br&gt;败，并报上面的错误&lt;/p&gt;
&lt;p&gt;解决方法1：在Manifest.xml的application标签下添加tools:replace=”android:icon, android:theme”（多个属性用,隔开，并且记住在manifest根标签上加入xmlns:tools=”&lt;a href=&quot;http://schemas.android.com/tools&amp;quot;，否则会找不到namespace哦）&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://schemas.android.com/tools&amp;quot;，否则会找不到namespace哦）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;解决方法2：在build.gradle根标签上加上useOldManifestMerger true （懒人方法）&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;##Exception 2&lt;/p&gt;
&lt;h4 id=&quot;关键字：-1&quot;&gt;&lt;a href=&quot;#关键字：-1&quot; class=&quot;headerlink&quot; title=&quot;关键字：&quot;&gt;&lt;/a&gt;关键字：&lt;/h4&gt;&lt;p&gt;Error type 3， activity class does not exist&lt;/p&gt;
&lt;h4 id=&quot;log-1&quot;&gt;&lt;a href=&quot;#log-1&quot; class=&quot;headerlink&quot; title=&quot;log&quot;&gt;&lt;/a&gt;log&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.codealchemist.clashmma/.splash }
Error type 3
Error: Activity class {com.codealchemist.clashmma/com.codealchemist.clashmma.splash} does not exist.
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&quot;现象-1&quot;&gt;&lt;a href=&quot;#现象-1&quot; class=&quot;headerlink&quot; title=&quot;现象&quot;&gt;&lt;/a&gt;现象&lt;/h4&gt;&lt;p&gt;用android studio运行app，如果修改了包名，启动的时候会出现如下错误&lt;/p&gt;
&lt;h4 id=&quot;原因及解决办法-1&quot;&gt;&lt;a href=&quot;#原因及解决办法-1&quot; class=&quot;headerlink&quot; title=&quot;原因及解决办法&quot;&gt;&lt;/a&gt;原因及解决办法&lt;/h4&gt;&lt;p&gt;在build.gradle中把 apply plugin: ‘android’ 改为 apply plugin: ‘com.android.application’&lt;/p&gt;
&lt;p&gt;##Exception 1&lt;/p&gt;
&lt;h4 id=&quot;关键字：-2&quot;&gt;&lt;a href=&quot;#关键字：-2&quot; class=&quot;headerlink&quot; title=&quot;关键字：&quot;&gt;&lt;/a&gt;关键字：&lt;/h4&gt;&lt;p&gt;JNI ERROR (app bug): accessed stale local reference、jclass is an invalid local reference&lt;/p&gt;
&lt;h4 id=&quot;log-2&quot;&gt;&lt;a href=&quot;#log-2&quot; class=&quot;headerlink&quot; title=&quot;log&quot;&gt;&lt;/a&gt;log&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;E/art﹕ JNI ERROR (app bug): accessed stale local reference 0x5950001d (index 7 in a table of size 1)
E/art﹕ 0xa96b4c00 SpaceTypeMallocSpace begin=0x12c00000,end=0x13001000,limit=0x32c00000,size=4MB,capacity=512MB,non_growth_limit_capacity=512MB,name=&amp;quot;main 
art/runtime/check_jni.cc:65] JNI DETECTED ERROR IN APPLICATION: jclass is an invalid local reference: 0x5950001d (0xdead4321)
E/art﹕ [ 05-26 16:03:20.096 26663:26768 F/art      ]
art/runtime/check_jni.cc:65] JNI DETECTED ERROR IN APPLICATION: jclass is an invalid local reference: 0x5950001d (0xdead4321)
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&quot;现象-2&quot;&gt;&lt;a href=&quot;#现象-2&quot; class=&quot;headerlink&quot; title=&quot;现象&quot;&gt;&lt;/a&gt;现象&lt;/h4&gt;&lt;p&gt;android5.0以上，调用jni相关方法后，程序崩溃&lt;/p&gt;
&lt;h4 id=&quot;原因及解决办法-2&quot;&gt;&lt;a href=&quot;#原因及解决办法-2&quot; class=&quot;headerlink&quot; title=&quot;原因及解决办法&quot;&gt;&lt;/a&gt;原因及解决办法&lt;/h4&gt;&lt;p&gt;通过findclass获得的local&lt;br&gt;reference在5.0以上版本会被系统gc掉，导致后续使用的地方会无效。现在的解决方案是使用NewGlobalRef，如下&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jclass myclass；
jclass temp = env-&amp;gt;findclass(XXXX);
myclass = (jclass)env-&amp;gt;NewGlobalRef(temp);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;记得要调用DeleteGlobalRef&lt;/p&gt;
&lt;p&gt;另外以下几个链接也可以参考一下 &lt;a href=&quot;http://android-developers.blogspot.com/2011/11/jni-local-reference-changes-in-ics.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JNI Local Reference Changes in&lt;br&gt;ICS&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.k-res.net/archives/1525.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;国内的翻译&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;##Exception 3&lt;/p&gt;
&lt;h4 id=&quot;关键字：&quot;&gt;&lt;a href=&quot;#关键字：&quot; class=&quot;headerlink&quot; title=&quot;关键字：&quot;&gt;&lt;/a&gt;关键字：&lt;/h4&gt;&lt;p&gt;Android studio gradle add tools:replace&lt;/p&gt;
&lt;h4 id=&quot;log&quot;&gt;&lt;a href=&quot;#log&quot; class=&quot;headerlink&quot; title=&quot;log&quot;&gt;&lt;/a&gt;log&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;Error:(26, 9) Attribute application@icon value=(@drawable/logo) from AndroidManifest.xml:26:9
Error:(28, 9) Attribute application@theme value=(@style/ThemeActionBar) from AndroidManifest.xml:28:9
is also present at XXXX-trunk:XXXXLib:unspecified:15:9 value=(@style/AppTheme)
Suggestion: add &amp;apos;tools:replace=&amp;quot;android:theme&amp;quot;&amp;apos; to  element at AndroidManifest.xml:24:5 to override
Error:Execution failed for task &amp;apos;:XXXX:processDebugManifest&amp;apos;.
 Manifest merger failed with multiple errors, see logs
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&quot;现象&quot;&gt;&lt;a href=&quot;#现象&quot; class=&quot;headerlink&quot; title=&quot;现象&quot;&gt;&lt;/a&gt;现象&lt;/h4&gt;&lt;p&gt;用gradle编译工程，出错，无法运行&lt;/p&gt;
&lt;h4 id=&quot;原因及解决办法&quot;&gt;&lt;a href=&quot;#原因及解决办法&quot; class=&quot;headerlink&quot; title=&quot;原因及解决办法&quot;&gt;&lt;/a&gt;原因及解决办法&lt;/h4&gt;&lt;p&gt;原因：AS的Gradle插件默认会启用Manifest Merger Tool，若Library项目中也定义了与主项目相同的属性（例如默认生成的android:icon和android:theme），则此时会合并失&lt;br&gt;败，并报上面的错误&lt;/p&gt;
&lt;p&gt;解决方法1：在Manifest.xml的application标签下添加tools:replace=”android:icon, android:theme”（多个属性用,隔开，并且记住在manifest根标签上加入xmlns:tools=”&lt;a href=&quot;http://schemas.android.com/tools&amp;quot;，否则会找不到namespace哦）&quot;&gt;http://schemas.android.com/tools&amp;quot;，否则会找不到namespace哦）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;解决方法2：在build.gradle根标签上加上useOldManifestMerger true （懒人方法）&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="http://jathew.github.io/tags/android/"/>
    
  </entry>
  
</feed>
